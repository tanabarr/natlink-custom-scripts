<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<title>technical details, natlinkconfigfunctions</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<meta name="description" content="SourceForge project for Dragon NaturallySpeaking macro facility">
<meta name="keywords" content="Installation, NatlinkfVocolafUnimacro, technical, details, natlinkconfigfunctions, technical details, Installation Natlink/Vocola/Unimacro">
<meta name="author" content="QH software, training & advies, 2002/2012 (informatie: info at sitegen.nl)">
<link rel="stylesheet" href="../../unimacro.css" type="text/css" title="unimacro.css">
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../unimacroie6.css" type="text/css" title="unimacroie6.css">
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" href="../../unimacroie7.css" type="text/css" title="unimacroie7.css">
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" href="../../unimacroie8.css" type="text/css" title="unimacroie8.css">
<![endif]-->
<!--[if IE 9]>
<link rel="stylesheet" href="../../unimacroie9.css" type="text/css" title="unimacroie9.css">
<![endif]-->
<script language="javascript" src="../../unimacro.js" type="text/javascript"></script><link href="/unimacro/favicon.ico" rel="shortcut icon" type="image/x-icon"></head>
<body onload="afterLoad();" onresize="onResize();"><div class="header" id="header"><!-- === start of header === -->

<table border="0" cellpadding="0" cellspacing="0" class="body" width="100%">

<tr><td class="banner">Unimacro</td>
<td width="30%">&nbsp;</td></tr></table>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td height="15"></td></tr></table>

<table border="0" cellspacing="0" class="menu" width="100%">
<tr><td align="center" class="topon" height="28" onclick="location='../installation.html';" onmouseout="status='';" onmouseover="status='Installation Natlink/Vocola/Unimacro';"><a href="../installation.html">Installation Natlink/Vocola/Unimacro</a></td>
<td class="topspacer" height="28" width="5">&nbsp;</td>
<td align="center" class="topoff" height="28" onclick="location='../../features/index.html';" onmouseout="status='';" onmouseover="status='Features';"><a href="../../features/index.html">Features</a></td>
<td class="topspacer" height="28" width="5">&nbsp;</td>
<td align="center" class="topoff" height="28" onclick="location='../../grammars/index.html';" onmouseout="status='';" onmouseover="status='Grammars';"><a href="../../grammars/index.html">Grammars</a></td>
<td class="topspacer" height="28" width="5">&nbsp;</td>
<td align="center" class="topoff" height="28" onclick="location='../../aboutunimacro/index.html';" onmouseout="status='';" onmouseover="status='about Unimacro';"><a href="../../aboutunimacro/index.html">about Unimacro</a></td></tr>
</table>

<table border="0" cellpadding="0" cellspacing="0" class="navline" width="100%">

<tr><td class="navline"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td class="navline">&nbsp;<a href="../../index.html">home</a> > <a href="../installation.html">installation natlink/vocola/unimacro</a> > <a href="index.html">technical details</a> > natlinkconfigfunctions</td></tr>
</table></td></tr>
</table>

<!-- === end of header === --></div><div class="body" id="divbody"><table cellspacing="0" class="body" width="100%">
<tr><td class="leftpart" id="leftpart" width="25%"><table cellspacing="0" class="leftpart" width="100%">
<tr><td class="leftmenu" id="leftmenu"><!-- === left menu === -->
<table class="leftmenu" cellspacing="0" width="100%">
<tr><td class="leftoff" colspan="2"><a href="../installation.html">Installation</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../configuration.html">Configuration</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../howtostart.html">How to start</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../logofchanges/index.html">Log of changes</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../problemswithinstallation.html">Problems with installation?</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../problemswithnatlink.html">Problems with NatLink?</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../speechmodel.html">Speech Model</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../inifilestrategy.html">Ini file strategy</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../configureadministratorrights.html">Configure administrator rights</a></td></tr>

<tr><td class="lefton" colspan="2"><a href="index.html">Technical details</a></td></tr>
    
<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkstatus.html">Natlinkstatus</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="lefton">Natlinkconfigfunctions</td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="configuregui.html">configure GUI</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="batchmodeforconfiguration.html">Batch mode for configuration</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="installer.html">Installer</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkmain_vocola_main.html">Natlinkmain_vocola_main</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkmain.html">Natlinkmain</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkutils.html">Natlinkutils</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="nsformat.html">Nsformat</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="testingnatlink.html">Testing natlink</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="workingwithsubversion/index.html">Working with subversion</a></td></tr>
</table>

<!-- == end of left menu == --></td></tr>
</table></td>
<td class="body0" id="body0" width="76%"><table cellspacing="0" class="body" width="100%">
<tr><td class="body" id="body" valign="top"><h1>NatLink Configuration Functions</h1>
<p>This module <strong>natlinkconfigfunctions.py</strong> is in the same directory as the configure GUI.  It contains the necessary functions for the configuration procedure. If run direct, use</p>
<ul><li>IDLE (right click on the file, Edit with IDLE and press F5.  (at exit (q) some strange message may show up, just ignore)</li><li>python (right click on the file, Open with, python)</li><li>PythonWin (right click on the file, Edit with PythonWin; Press F5)</li></ul>
<p>When the CLI starts, some checks are performed as to the current installation:</p>
<ul><li>It must find the coreDirectory to be in the same directorypart as the calling module. If this fails, something strange is happening.</li><li>The path coreDirectory are compared with settings in registry of the PythonPath section. If something differs, you are asked to either</li><li>(re)register NatLink.dll, and setting the correct paths in the registry. Quit the program and all python applications and restart NatSpeak.</li><li>quit this program and rerun from the location you have your NatLink installation files.</li></ul>
<h3>The current commands of the CLI are:</h3>
<p class="pre">"""<br>
[Status]<br>
i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- info, print information about the NatLink status<br>
I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- settings, print information about the natlinkstatus.ini settings<br>
j&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- print PythonPath variable<br>
<br>
[NatLink]<br>
e&frasl;E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable&frasl;disable NatLink<br>
<br>
g&frasl;G&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable&frasl;disable debug output, which is sent to the NatSpeak&frasl;Dragon log file<br>
y&frasl;Y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable&frasl;disable debug callback output of natlinkmain<br>
x&frasl;X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable&frasl;disable debug load output&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of natlinkmain<br>
<br>
d&frasl;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- set&frasl;clear DNSInstallDir, the directory where NatSpeak&frasl;Dragon is installed<br>
c&frasl;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- set&frasl;clear DNSINIDir, where NatSpeak&frasl;Dragon INI files are located<br>
<br>
[Vocola]<br>
v&frasl;V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable&frasl;disable Vocola by setting&frasl;clearing VocolaUserDir, the user<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory for Vocola user files (~ or %HOME% allowed).<br>
<br>
b&frasl;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable&frasl;disable distinction between languages for Vocola user files<br>
a&frasl;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable&frasl;disable the possibility to use Unimacro actions in Vocola<br>
<br>
[Unimacro]<br>
n&frasl;N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable&frasl;disable Unimacro by setting&frasl;clearing UserDirectory, the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory where user NatLink grammar files are located (e.g.,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...\My Documents\NatLink)<br>
f&frasl;F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- force Unimacro directory to be in the python path, even if<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the userDirectory is set to another path (-F: do not force this)<br>
o&frasl;O&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- set&frasl;clear UnimacroUserDir, where Unimacro user INI files are located<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(~ or %HOME% allowed)<br>
p&frasl;P&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- set&frasl;clear path for program that opens Unimacro INI files.<br>
l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- copy header file Unimacro.vch into Vocola User Directory<br>
m&frasl;M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- insert&frasl;remove an include line for Unimacro.vch in all Vocola<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command files<br>
<br>
[Repair]<br>
r&frasl;R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- register&frasl;unregister NatLink, the natlink.pyd (natlink.pyd) file<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(should not be needed)<br>
z&frasl;Z&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- silently enables NatLink and registers natlink.pyd &frasl; disables NatLink<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and unregisters natlink.pyd.<br>
[AutoHotkey]<br>
h&frasl;H&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- set&frasl;clear the AutoHotkey exe directory.<br>
k&frasl;K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- set&frasl;clear the User Directory for AutoHotkey scripts.<br>
[Other]<br>
<br>
u&frasl;usage - give this list<br>
q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- quit<br>
<br>
help &lt;command&gt;: give more explanation on &lt;command&gt;</p>

<h3>Using ~ or %USERNAME% etc.</h3>
<p>Using these variables (<strong>~</strong> is equal to <strong>%HOME%</strong>), variable paths can be set for the various directories. This can only be done by using the CLI, or using the natlinkconfigfunctions in batch mode. <strong>Not through the config GUI</strong>.</p>

<h3>enable&frasl;disable NatLink</h3>
<p>The commands <strong>e</strong> to enable and <strong>E</strong> to disable should be enough.</p>

<h3>enable&frasl;disable Vocola</h3>
<p>Assume <strong>_vocola_main.py</strong> is in the baseDirectory (Macrosystem).</p>

<p>Vocola will be enabled when a valid VocolaUserDirectory is set with the <strong>v</strong> option.</p>

<p>When this directory is cleared (<strong>V</strong>) Vocola will not load.</p>

<h3>enable&frasl;disable Unimacro</h3>
<p>This is done by setting a userDirectory (option <strong>u</strong>)  (the path can be for example: <em>D:&frasl;NatLink&frasl;unimacro</em> or <em>%PROGRAMFILES%&frasl;NatLink&frasl;unimacro</em>).</p>

<p>Disable by clearing this directory (option <strong>U</strong>).</p>
<h3>Special Vocola option: use different languages</h3>
<p>If enabled (<strong>b</strong>), Vocola will look into a subdirectory "xxx" of
VocolaUserDirectory IF the language code of
the user speech profiles is different from "enx".</p>

<p>So for English users this option will have no effect.</p>
<p>If you call for a new command file, it looks first into the default directory, being one above.  So when the VocolaUserDirectory is  <strong>~\Vocola</strong> the English speech profiles will be in this directory , but</p>
<ul><li>Dutch will go in <strong>~\Vocola\nld</strong>,</li><li>French in <strong>~\Vocola\fra</strong></li><li>German  in <strong>~\Vocola\deu</strong></li><li>Italian in <strong>~\Vocola\ita</strong></li></ul>
<p>But as soon as you switch off this option (<strong>B</strong>) Vocola will only look again into the VocolaUserDirectory ( in our example: <strong>~\Vocola</strong>)</p>

<p>Note: <strong>~</strong> is a shorthand for your <strong>PERSONAL</strong> of <strong>HOME</strong> folder, by default pointing to your my documents folder. And <strong>%PROGRAMFILES%</strong> will locate your program files directory.</p>

<p>If your <strong>HOME</strong> or <strong>PERSONAL</strong> is not pointing to the correct folder, try to change the properties of your Documents folder in the Windows Explorer or change in the Environments Variables of the Windows Properties dialog.</p>
<ul><li>Note: more detailed instructions are welcome from somebody who hits upon this problem.</li></ul>
<h3>Python versions</h3>
<p>Natlink.pyd is still compiled for python 2.5, but only for Dragon up to version 11.5.</p>

<p>For both Dragon &lt;= 11.5 and for Dragon 12 there are now natlink.pyd versions for python 2.6 and python 3.7.</p>

<h3>Older versions of Dragon NaturallySpeaking</h3>
<p>Older versions of Dragon should be working with Python 2.5, 2.6 and 2.7.</p>

<p>If you have an older version of Dragon NaturallySpeaking, tried to configure the</p>
<ul><li>DNSInstallDir (option <strong>d</strong>) and</li><li>DNSIniDir (option <strong>c</strong>).</li></ul>
<h3>Path strategy</h3><ul><li>The coreDirectory is inserted in the python path by defining them in the registry HKLM\SOFTWARE\Python\PythonCore\2.7\PythonPath\NatLink (HKLM stands for HKEY_LOCAL_MACHINE)</li><li>The BaseDirectory, UserDirectory (for Unimacro or other user grammars) is set by natlinkmain.py, when NatSpeak starts.</li><li>If the UserDirectory is NOT Unimacro, still Unimacro features can be used if the <strong>-f</strong> option is used. The Original Unimacro directory is added to the path, but only if the directory structure is as the installer does it (..\..\..\Unimacro relative to the Core directory)</li><li>This <strong>-f</strong> trick can also be used for Vocola, using Unimacro Shorthand Commands, while Unimacro is not activated.</li></ul></td></tr>
</table></td></tr>
</table></div><div class="footer" id="footer"><!-- === start of footer === -->

<table border="0" cellpadding="0" cellspacing="0" class="bottomline" width="100%">

<tr><td class="navline"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td class="navline">&nbsp;<a href="../../index.html">home</a> > <a href="../installation.html">installation natlink/vocola/unimacro</a> > <a href="index.html">technical details</a> > natlinkconfigfunctions > 
<a href="javascript:scrollTo(0,0);">top</a></td></tr>
</table></td>
<td class="sitemapbutton" onclick="location='../../sitemap.html#natlinkconfigfunctions';" onmouseout="status='';" onmouseover="status='go to the sitemap';"><a href="../../sitemap.html#natlinkconfigfunctions">sitemap</a></td>
<td class="navline" width="5"></td>
<td class="emailbutton" onclick="" onmouseout="status='';" onmouseover="status='send e-mail';"><noscript class="underline">q.hoogenboom</noscript>
<script language="javascript" type="text/javascript"><!--
m("antenna.nl", "q.hoogenboom", "information about: natlinkconfigfunctions", "e-mail");
// --></script>
<noscript class="underline">at&nbsp;antenna.nl</noscript></td>
<td class="navline" width="5"></td>
<td class="copyright">&copy;&nbsp;<strong>unimacro</strong>,&nbsp;okt 2014</td>
<td class="copprintonly">&copy;&nbsp;<strong>unimacro</strong>,&nbsp;okt 2014<br> | a SourceForge Project by Quintijn Hoogenboom, Ben Staniford, Bart Jan van Os, Frank Olaf Sem-Jacobsen.</td></tr>
</table>

<!-- === end of footer === --></div>
<script language="javascript" type="text/javascript"><!--
function onResizeFunctions(){
bodyHeight(170);
}

function onLoadFunctions(){
onResizeFunctions();

return;
}

// --></script>

</body></html>